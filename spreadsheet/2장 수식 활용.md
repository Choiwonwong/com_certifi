### 074 수식 작성 / 오류 메시지

##### 1. 수식의 개념
수식이란 워크시트에 입력된 데이터를 계산하거나 분석하기 위한 식을 말한다.

+ 수식에서는 더하기와 곱하기 같은 연산을 수행하며 워크시트 값을 비교하거나 텍스트를 결합할 수 있다.
+ 수식은 등호나 +, - 기호로 시작한다,
+ 문자열이 수식에 사용될 때에는 큰 따옴표로 묶어주어야 한다.
+ 수식은 같은 워크시트의 다른 셀이나 같은 통합 문서의 다른 시트에 있는 셀, 다른 통합 문서의 시트에 있는 셀 등을 참조할 수 있다.
+ 수식이 입력된 셀에는 수식의 결과값이 표시되고, 수식은 수식 입력줄에 표시된다,
+ CTRL + ~ 을 누르면 워크시트에 입력된 전체 수식을 볼 수 있다.
+ 수식을 입력한 후 결과값이 수식이 아닌 상수로 입력되게 하려면 수식을 입력한 후 F9을 누른다.

###### 수식 입력
+ +을 입력한 경우는 =로 변경되어 입력되고, -를 맨 처음에 입력한 경우는 =-로 변경되어 입력된다.

1. 결과가 계산될 셀에 수식을 직접 입력한다.
2. 수식에서 참조할 셀을 마우스와 키보드로 선택하면서 입력한다.

###### 수식을 상수로 입력하기
+ =SUM(A1:B1)을 입력한 후 F9를 누르면 수식 입력줄의 =SUM()이 3으로 변경된다.

###### F9의 다른 기능
+ 수식의 계산 방법이 수동으로 지정되어 있는 경우 F9를 누르면 열려 있는 통합 문서의 모든 워크시트에 입력된 수식이 다시 계산된다.

##### 2. 산술 연산자
더하기, 빼기, 곱하기 같은 기본 수치 연산을 수행하여 수치 결과를 얻을 때 사용
( * ) : 곱하기, % : 백분율. / : 나누기, ^ : 지수

##### 3. 비교 연산자
두 값의 크기를 비교하여 참, 거짓 과 같은 논리값으로 표현한다.
( >, <, <=, >=, <>, = ) 사용됨.

##### 4. 텍스트 연산자
텍스트 문자열을 연결하여 하나의 텍스트로 만들 때 사용한다.

+ & : 두 문자열을 연결하여 연속하는 하나의 문자열을 만든다.

##### 5. 참조 연산자
셀 참조 범위를 설정하기 위해 사용하는 것으로 주로 함수 안에서 사용한다.

+ :(콜론) 범위 연산자
  + 연속적인 셀 범위를 지정한다.
  + 'A1:A5' -> [A1]에서 [A5]까지의 범위를 참조 영역으로 지정한다.

+ ,(쉼표) 결합 연산자
  + 비연속적인 셀 범위를 지정한다.
  + 'A1:A3', 'B1:B3' -> [A1]셀에서 [A3] 셀가지의 범위와 [B1] 셀에서 [B3]  셀까지의 범위를 참조 영역으로 지정한다.

+  (공백) 교점 연산자
  + 두 개의 참조 영역에서 공통인 셀을 참조 영역으로 지정한다.
  + 'A1:A5 A3:E3' -> 두 영역의 공통 영역인 [A3] 셀을 참조영역으로 지정한다.

##### 6. 연산자 우선순위
우선순위가 같은 연산자는 왼쪽에서부터 오른쪽으로 우선순위를 갖고 계산된다.
+ 괄호를 묶어주면 항상 괄호 안부터 연산이 시작된다.
+ 연산자 간의 우선순위는 참조 연산자 > 산술 연산자 > 텍스트 연산자 > 비교 연산자 순이다.

+ :(범위 연산자) ,(결합 연산자) 공백(교점 연산자) -(음수) %(백분율) ^(지수) * / (곱셈, 나눗셈) +-(덧셈, 뺄셈) &(문자열 결합) 비교연산자

##### 7. 오류 메시지
정상적인 결과를 산출할 수 없을 경우에 나타난다.

+ #### : 셀에 셀 너비보다 큰 숫자, 날짜 또는 시간이 있거나 셀에 계산 결과가 음수인 날짜와 시간이 있을 때
+ #DIV/0! : 나누는 수가 빈 셀이나 0이 있는 셀을 참조한 때
+ #N/A : 함수나 수식에 사용할 수 없는 값을 지정했을 때
+ #NAME? : 인식할 수 없는 텍스트를 수식에 사용했을 때
+ #NULL! : 교차하지 않는 두 영역의 교점을 지정하였을 때
+ #NUM! : 표현할 수 있는 숫자의 범위를 벗어났을 때
+ #REF! : 셀 참조가 유효하지 않을 때

###### 순환 참조 경고
+ 수식에서 직접 또는 간접적으로 수식이 입력된 그 셀을 그 수식에서 참조하는 경우를 순환 참조라고 하고, 순환 참조인 경우 아래와 같은 메시지가 표시된다.
  + 하나 이상의 수식에 순환 참조가 포함되어 있으며 제대로 계산할 수 없다.~~~~~~

### 075 셀 참조 / 이름 정의

##### 1. 참조
+ 참조는 수식에서 워크시트의 특정 셀이나 셀 범위의 데이터, 또는 결과값을 사용하기 위해 주소를 지정하는 것을 말한다.
+ 수식에 사용된 셀의 값이 변경되면 변경된 셀을 참조하는 수식의 값도 자동으로 재계산된다.

##### 2. 참조의 종류

1. 상대 참조
  + 셀 참조 시 기본적으로 지정되는 방식이다.
  + 수식을 입력한 셀의 취치가 변동되면 참조가 상대적으로 변경된다.
  + 표기 방법 : A1

2. 절대 참조
  + 수식을 입력한 셀의 위치에 관계 없이 고정된 주소로, 참조가 변경되지 않는다.
  + 열 문자와 행 번호 앞에 $을 붙여 절대 참조로 지정한다.
  + 표기 방법 : $A$1

3. 혼합 참조
  + 절대 참조와 상대 참조를 혼합하여 사용한다.
  + 열 고정 혼합 참조 : 열만 절대 참조가 적용된다.
  + 행 고정 혼합 참조 : 행만 절대 참조가 적용된다.

###### F4를 이용한 참조 전환
+ F4를 이용하면 $를 직접 입력하지 않고도 셀 주소를 변환할 수 있다.
+ F4를 한 번씩 누를 때 마다 절대참조 -> 행 고정 혼합 참조 -> 열 고정 혼합 참조 -> 상대 참조 순으로 전환된다.

###### R1C1 참조 스타일

+ R 뒤에 행 번호를 C 뒤에 열 번호를 서서 셀의 위치를 표시하는 형태이다.

##### 3. 다른 워크시트의 셀 참조
+ 다른 워크시트에 있는 셀의 데이터를 참조할 경우 시트 이름과 셀 주소를 느낌표로 구분한다.
+ 워크시트 이름에 한글, 영어 외의 다른 문자가 잇을 경우 작은따옴표로 구분한다.
  + 시트 이름에 공백이 들어간 경우 시트 명이 작은 따옴표로 묶인다.

##### 4. 3차원 참조
+ 여러 시트의 동일한 셀이나 셀 범위에 대한 참조를 3차원 참조라고 한다,
+ 참조하는 시트가 연속적으로 나열되어 있고 셀 주소가 모두 동일할 때는 첫 번째 시트와 마지막 시트의 이름을 콜론으로 연결하고 셀 주소를 한 번만 지정하면 된다.
+ SUM, AVERAGE, AVERAGEA, COUNT, MAX, MIN 등의 함수에서 사용할 수 있다.
+ 배열 수식에서는 3차원 참조를 사용할 수 없다.

##### 5. 다른  통합 문서의 셀 참조
+ 다른 통합 문서에 있는 셀의 데이터를 참조할 경우 통합 문서의 이름을 대괄호로 묶어준다.
+ 경로 명은 작은따옴표로 묶어준다.

##### 6. 이름 정의
이름 정의란 자주 사용하는 셀이나 셀 범위에 이름을 지정하는 것으로, 수식이나 함수에서 주소 대신 이름을 참조하여 사용한다.
+ 정의된 이름을 사용하면 수식이나 함수에서 참조 범위를 쉽게 지정할 수 있으며, 함수나 수식의 의미를 좀 더 명확히 할 수 있다.
+ 정의된 이름은 참조 시 절대 참조 방식으로 사용된다.

###### 이름 작성 규칙
+ 첫 문자는 반드시 문자나 밑줄 도는 역슬래시로 시작해야 한다.
+ 이름에 +, -, *  같은 특수문자나 공백은 포함할 수 없다.
+ 대/소문자는 구분하지 않으며 최대 255자까지 지정할 수 있다.
+ 통합 문서내에서 동일한 이름을 중복하여 사용할 수 없다.

### 076 함수 기본

##### 1. 함수의 정의
함수는 약속된 값으로 정의된 인수를 사용하여 계산하는, 프로그램에 이미 정의된 수식을 말한다.
+ 함수는 수식과 같이 등호, +, - 로 시작해야 한다.
+ 함수는 함수 이름, 왼쪽 괄호, 쉼표로 구분된 함수의 인수, 오른쪽 괄호로 구성된다.
+ 함수에 따라 인수 업싱 괄호로만 사용하는 경우도 있다.
+ 함수의 인수로 또다른 함수를 사용하는 중첩 함수를 사용할 수 있으며, 64단계까지 중첩할 수 있다.

###### 인수
+ 함수의 계산에 필요한 값을 말한다.
+ 일반적으로 인수에는 숫자, 텍스트, 셀 주소, 셀 범위, 함수 등이 사용된다.
+ 인수의 시작과 끝은 반드시 괄호로 구분하고, 인수와 인수는 쉼표로 구분한다.
+ 인수는 255개까지 사용이 가능하다.

##### 2. 함수 마법사
[수식]-[함수 라이브러리]-[함수 삽입]or [함수 삽입 아이콘 클릭]

<hr>

### 077 함수 종류1
##### 1. 통계 함수
1. AVERAGE(~~) : 인수의 평균값
2. AVERAGEA(~~) : 수치가 아닌 셀을 포함하는 인수의 평균값
3. AVERAGEIF(조건이 적용될 범위, 조건, 평균을 구할 범위) : 조건에 맞는 셀들의 평균값
